[2026-02-23T17:43:19] Logging to: /run/media/saveas/Secondary-Storage/Masters/CS234/CS234_Reinforcement_Learning/Final Project/CS234_Final_Project/results/trajectory_optimization/run_trajopt_demo_output.log
======================================================================
IPOPT TRAJECTORY OPTIMIZATION DEMO (STAGE A/B)
======================================================================

1. Loading track: /run/media/saveas/Secondary-Storage/Masters/CS234/CS234_Reinforcement_Learning/Final Project/CS234_Final_Project/maps/Medium_Oval_Map_260m_Obstacles.mat
   Track length: 260.0 m

2. Creating vehicle model...
   Vehicle: SingleTrackModel(VW_Golf_GTI, weight_transfer=enabled)

3. Loaded obstacles from map: 4

4. Setup:
   N = 60
   ds = 4.33 m

======================================================================
STAGE A: FEASIBILITY
======================================================================

******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit https://github.com/coin-or/Ipopt
******************************************************************************

This is Ipopt version 3.14.11, running with linear solver MUMPS 5.4.1.

Number of nonzeros in equality constraint Jacobian...:     6367
Number of nonzeros in inequality constraint Jacobian.:      905
Number of nonzeros in Lagrangian Hessian.............:     2972

Total number of variables............................:      854
                     variables with only lower bounds:        0
                variables with lower and upper bounds:        0
                     variables with only upper bounds:        0
Total number of equality constraints.................:      490
Total number of inequality constraints...............:      849
        inequality constraints with only lower bounds:      605
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:      244

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  2.6000000e-01 2.16e+00 5.45e+01  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
   1 -6.3031225e+03 2.15e+00 5.43e+01  -1.0 2.73e+00   2.0 2.66e-02 9.01e-03f  1
   2 -9.2995477e+03 2.12e+00 5.37e+01  -1.0 2.71e+00   2.4 3.88e-02 1.32e-02f  1
   3 -1.0787020e+04 2.07e+00 6.38e+01  -1.0 2.68e+00   2.9 2.92e-02 2.28e-02f  1
   4 -1.0858827e+04 2.03e+00 8.17e+02  -1.0 2.62e+00   3.3 1.54e-01 1.70e-02h  1
   5 -9.8665561e+03 1.96e+00 1.40e+03  -1.0 2.58e+00   3.7 8.12e-02 3.88e-02h  1
   6 -7.1028357e+03 1.65e+00 1.67e+03  -1.0 2.51e+00   3.2 3.29e-01 1.57e-01H  1
   7 -1.1226343e+03 1.29e+00 1.20e+03  -1.0 2.18e+00   2.7 3.64e-01 2.12e-01h  1
   8  1.1370230e+03 1.15e+00 1.11e+03  -1.0 1.72e+00   2.3 9.72e-01 1.11e-01h  1
   9 -5.6837574e+03 1.02e+00 1.20e+03  -1.0 9.20e+02   1.8 3.41e-03 7.73e-04f  1
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  10 -2.1471870e+03 8.27e-01 1.01e+03  -1.0 1.45e+00   2.2 2.27e-02 1.90e-01h  1
  11 -2.1369998e+03 8.27e-01 1.01e+03  -1.0 4.49e+01   1.7 3.06e-04 1.81e-04h  9
  12  9.1583782e+03 2.24e+00 4.69e+02  -1.0 1.29e+00   2.2 1.00e+00 5.86e-01H  1
  13  1.5183448e+04 1.33e+00 1.66e+03  -1.0 6.47e-01   2.6 7.83e-01 1.00e+00h  1
  14  1.4366760e+04 1.82e-01 6.35e+02  -1.0 3.40e-02   3.0 1.00e+00 1.00e+00f  1
  15  1.3250001e+04 1.03e-01 3.54e+02  -1.0 9.99e-02   2.5 1.00e+00 4.51e-01f  1
  16  1.1106695e+04 6.39e-02 2.16e+02  -1.0 2.33e-01   2.1 9.64e-01 3.98e-01f  1
  17  4.8502945e+03 2.35e-02 7.90e+01  -1.0 5.19e-01   1.6 1.00e+00 6.39e-01f  1
  18  4.5894897e+03 2.32e-02 7.78e+01  -1.0 1.56e+00   1.1 1.00e+00 1.46e-02f  1
  19  2.4498405e+03 2.18e-02 7.36e+01  -1.0 3.61e+00   0.6 1.00e+00 5.94e-02f  1
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  20  2.4371553e+03 8.02e-02 2.78e+01  -1.0 4.40e-01   0.2 2.85e-01 8.79e-01f  1
  21  2.4543742e+03 6.89e-03 9.38e-01  -1.0 3.26e-02   0.6 9.94e-01 1.00e+00f  1
  22  4.9644124e+02 1.08e-03 1.17e-01  -1.7 9.12e-02   0.1 1.00e+00 1.00e+00f  1
  23  7.7035473e+01 2.24e-04 8.06e-03  -2.5 1.88e-02  -0.4 1.00e+00 1.00e+00f  1
  24  1.1010217e+01 2.12e-03 4.39e-03  -3.8 3.08e-02  -0.8 9.75e-01 1.00e+00f  1
  25  9.7777701e+00 2.66e-02 2.89e-03  -3.8 6.04e-02  -1.3 1.00e+00 1.00e+00h  1
  26  7.9689849e+00 5.37e-01 2.07e-02  -3.8 1.24e-01  -1.8 1.00e+00 1.00e+00h  1
  27  5.9569572e+00 1.75e+00 8.07e-02  -3.8 2.36e-01  -2.3 1.00e+00 1.00e+00h  1
  28  5.3476253e+00 4.12e+00 7.26e-02  -3.8 6.76e-01  -2.8 1.00e+00 5.26e-01h  1
  29  5.4043317e+00 3.86e+00 2.86e-02  -3.8 8.42e-01  -3.2 1.00e+00 5.00e-01h  2
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  30  4.8042783e+00 1.66e+00 2.12e-02  -3.8 8.47e-01  -3.7 1.00e+00 1.00e+00h  1
  31  4.6514714e+00 8.03e+00 2.51e-02  -3.8 2.90e+01    -  6.15e-01 1.00e+00h  1
  32  4.4344334e+00 3.71e+00 6.17e-03  -3.8 1.91e+01    -  1.00e+00 1.00e+00h  1
  33  4.4375374e+00 1.58e-01 5.66e-04  -3.8 9.60e-01    -  1.00e+00 1.00e+00h  1
  34  4.4388020e+00 4.61e-04 1.97e-06  -3.8 4.33e-02    -  1.00e+00 1.00e+00h  1
  35  7.3051969e-01 8.80e-01 1.90e-03  -5.7 1.02e+00    -  9.79e-01 1.00e+00h  1
  36  6.8608380e-01 1.44e+01 9.72e-03  -5.7 5.08e+00    -  1.00e+00 1.00e+00h  1
  37  6.8351969e-01 1.77e+00 2.35e-03  -5.7 1.06e+00    -  1.00e+00 1.00e+00h  1
  38  6.8660855e-01 5.47e-01 4.87e-04  -5.7 1.97e+00    -  1.00e+00 1.00e+00h  1
  39  6.8693655e-01 8.67e-03 2.37e-05  -5.7 9.85e-01    -  1.00e+00 1.00e+00h  1
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  40  6.8697240e-01 2.94e-04 1.63e-07  -5.7 2.55e-02    -  1.00e+00 1.00e+00h  1
  41  6.8697325e-01 1.87e-08 1.85e-11  -5.7 1.33e-04    -  1.00e+00 1.00e+00h  1
  42  6.4350692e-01 1.02e-02 6.57e-06  -7.0 3.78e-01    -  1.00e+00 1.00e+00h  1
  43  6.4352034e-01 5.76e-06 1.86e-09  -7.0 1.72e-02    -  1.00e+00 1.00e+00h  1
  44  6.4352033e-01 7.26e-13 9.09e-13  -7.0 5.41e-06    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 44

                                   (scaled)                 (unscaled)
Objective...............:   6.4352033471438350e-03    6.4352033471438352e-01
Dual infeasibility......:   9.0949470177292824e-13    9.0949470177292824e-11
Constraint violation....:   4.2472348836991090e-13    7.2564176889500231e-13
Variable bound violation:   0.0000000000000000e+00    0.0000000000000000e+00
Complementarity.........:   9.0909090909703650e-08    9.0909090909703654e-06
Overall NLP error.......:   9.0909090909703650e-08    9.0909090909703654e-06


Number of objective function evaluations             = 59
Number of objective gradient evaluations             = 45
Number of equality constraint evaluations            = 59
Number of inequality constraint evaluations          = 59
Number of equality constraint Jacobian evaluations   = 45
Number of inequality constraint Jacobian evaluations = 45
Number of Lagrangian Hessian evaluations             = 44
Total seconds in IPOPT                               = 3.617

EXIT: Optimal Solution Found.
      solver  :   t_proc      (avg)   t_wall      (avg)    n_eval
       nlp_f  |   7.15ms (121.20us)   7.17ms (121.50us)        59
       nlp_g  | 124.35ms (  2.11ms) 125.05ms (  2.12ms)        59
  nlp_grad_f  |  11.85ms (257.65us)  11.94ms (259.64us)        46
  nlp_hess_l  |   2.35 s ( 53.46ms)   2.36 s ( 53.72ms)        44
   nlp_jac_g  | 587.94ms ( 12.78ms) 591.27ms ( 12.85ms)        46
       total  |   3.60 s (  3.60 s)   3.62 s (  3.62 s)         1
  Success: True
  Cost: 0.6435
  Iterations: 44
  Solve time: 8.74 s
  Max obstacle slack: -9.0909e-09
  Min obstacle clearance: 0.0000 m

Generating Stage A plots...
  Saved: /run/media/saveas/Secondary-Storage/Masters/CS234/CS234_Reinforcement_Learning/Final Project/CS234_Final_Project/results/trajectory_optimization/ipopt_stage_a_trajectory.png
  Saved: /run/media/saveas/Secondary-Storage/Masters/CS234/CS234_Reinforcement_Learning/Final Project/CS234_Final_Project/results/trajectory_optimization/ipopt_stage_a_states.png
  Saved: /run/media/saveas/Secondary-Storage/Masters/CS234/CS234_Reinforcement_Learning/Final Project/CS234_Final_Project/results/trajectory_optimization/ipopt_stage_a_controls.png

======================================================================
STAGE B: MIN-TIME REFINEMENT
======================================================================
This is Ipopt version 3.14.11, running with linear solver MUMPS 5.4.1.

Number of nonzeros in equality constraint Jacobian...:     6367
Number of nonzeros in inequality constraint Jacobian.:      905
Number of nonzeros in Lagrangian Hessian.............:     2972

Total number of variables............................:      854
                     variables with only lower bounds:        0
                variables with lower and upper bounds:        0
                     variables with only upper bounds:        0
Total number of equality constraints.................:      490
Total number of inequality constraints...............:      849
        inequality constraints with only lower bounds:      605
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:      244

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  2.4352006e+01 7.26e-13 5.46e+01  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
   1 -2.1389248e+06 9.60e-03 5.39e+01  -1.0 3.25e-01   2.0 9.90e-01 3.05e-02f  1
   2 -1.1414790e+06 5.62e-03 3.85e+01  -1.0 1.63e-02   1.5 1.00e+00 4.17e-01h  1
   3  2.4388991e+05 2.10e-04 6.20e-01  -1.0 5.58e-02   1.0 1.00e+00 1.00e+00h  1
   4  4.8952327e+04 6.31e-06 2.85e-02  -1.7 7.68e-03   0.6 1.00e+00 1.00e+00f  1
   5  6.9207354e+03 4.50e-06 8.15e-03  -2.5 6.60e-03   0.1 1.00e+00 1.00e+00f  1
   6  3.8891456e+02 1.11e-07 4.16e-04  -3.8 1.01e-03  -0.4 1.00e+00 1.00e+00f  1
   7  2.6419102e+01 3.09e-09 5.95e-06  -5.7 4.34e-05  -0.9 1.00e+00 1.00e+00f  1
   8  1.1649094e+01 6.40e+00 1.08e-04  -8.6 1.92e+01    -  4.69e-01 1.00e+00f  1
   9  9.4218293e+00 1.68e+01 2.23e-04  -8.6 9.20e+00    -  7.25e-01 1.00e+00h  1
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  10  1.0152960e+01 1.42e+01 2.02e-04  -8.6 2.21e+01    -  5.75e-01 2.50e-01h  3
  11  1.1137230e+01 1.40e+01 8.46e-01  -8.6 8.04e+00  -1.3 1.07e-02 1.44e-02h  2
  12  1.0878295e+01 1.39e+01 8.33e-01  -8.6 7.63e+00  -0.9 3.53e-02 6.01e-03h  1
  13  1.1619039e+01 1.37e+01 7.53e-01  -8.6 7.94e+00  -1.4 9.27e-02 1.96e-02h  4
  14  1.1619782e+01 1.37e+01 9.20e-01  -8.6 7.79e+00  -1.0 1.14e-01 3.19e-05h 11
  15r 1.1619782e+01 1.37e+01 9.99e+02   1.1 0.00e+00  -1.4 0.00e+00 2.76e-07R 17
  16r 3.3407065e+04 3.93e+00 9.83e+02   1.1 1.14e+04    -  8.34e-02 1.09e-03f  1
  17  3.3268898e+04 3.93e+00 1.00e+02  -8.6 6.55e+05    -  2.53e-05 2.48e-09f  1
  18  3.0954801e+03 3.89e+00 9.92e+01  -8.6 3.80e+01    -  5.98e-01 8.39e-03f  1
  19  2.9353134e+03 3.79e+00 9.61e+01  -8.6 3.48e+01    -  2.83e-01 3.13e-02h  1
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  20  1.6568033e+03 1.19e+01 6.60e+01  -8.6 1.85e+01    -  8.44e-01 3.13e-01h  1
  21  1.3591428e+03 9.13e+00 5.46e+01  -8.6 4.21e+01    -  4.02e-01 1.73e-01h  3
  22  1.2575726e+03 1.39e+01 4.93e+01  -8.6 4.10e+00  -1.9 8.00e-04 9.63e-02H  1
  23  1.1773359e+03 1.05e+01 4.66e+01  -8.6 6.80e+00  -1.5 8.78e-02 5.56e-02h  1
  24  1.1473856e+03 1.03e+01 4.53e+01  -8.6 5.74e+01  -2.0 3.98e-02 2.69e-02h  1
  25  1.1467227e+03 1.37e+01 4.53e+01  -8.6 4.71e+02  -2.4 7.68e-04 1.13e-03h  2
  26  9.0004639e+02 1.48e+01 3.51e+01  -8.6 1.28e+01  -2.0 1.61e-02 2.25e-01h  1
  27  7.2050336e+02 1.10e+01 2.82e+01  -8.6 5.42e+00  -0.7 9.25e-09 1.96e-01h  1
  28  5.2964597e+02 8.55e+00 2.06e+01  -8.6 6.54e+00  -1.2 1.09e-07 2.71e-01h  1
  29  1.0010680e+02 1.34e+01 1.01e+02  -8.6 3.43e+00  -0.7 1.14e-08 9.40e-01h  1
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  30  9.9928733e+01 1.33e+01 1.01e+02  -8.6 3.05e+00   1.5 8.06e-02 1.49e-03h  1
  31  8.9524085e+01 9.71e+00 4.69e+03  -8.6 3.07e+00   1.9 8.38e-04 3.50e-01h  1
  32  8.9418955e+01 9.70e+00 4.68e+03  -8.6 2.00e+00   2.3 5.38e-02 8.78e-04h  1
  33  2.8812284e+03 9.55e+00 4.37e+03  -8.6 4.32e+01   1.9 6.43e-10 1.60e-02h  2
  34  5.9947417e+04 8.88e+00 3.63e+03  -8.6 1.96e+00   3.2 1.30e-02 9.32e-02h  1
  35  1.5900815e+05 6.87e+00 2.54e+03  -8.6 3.30e+00   2.7 1.46e-01 1.76e-01h  1
  36  1.9649634e+05 6.24e+00 3.76e+03  -8.6 1.68e+00   2.2 2.74e-01 1.00e-01h  2
  37  2.3492985e+05 6.94e+00 1.02e+04  -8.6 2.22e+00   2.7 2.23e-02 2.57e-01h  1
  38  2.4872893e+05 6.76e+00 9.65e+03  -8.6 1.63e+00   4.0 1.98e-05 3.48e-02h  1
  39  2.7412088e+05 6.18e+00 8.50e+03  -8.6 1.84e+00   3.5 6.80e-03 1.02e-01h  1
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  40  4.2096556e+05 4.62e+00 6.25e+03  -8.6 1.93e+00   3.0 6.08e-04 2.71e-01h  1
  41  4.2291003e+05 4.09e+00 5.55e+03  -8.6 1.79e+00   2.6 3.63e-01 1.17e-01h  1
  42  3.6718348e+05 3.67e+00 5.01e+03  -8.6 3.43e+00   2.1 3.36e-07 1.04e-01f  1
  43r 3.6718348e+05 3.67e+00 9.99e+02   0.5 0.00e+00   1.6 0.00e+00 1.40e-10R  2
  44r 8.8437322e+05 3.67e+00 9.99e+02   0.5 2.28e+08    -  2.33e-06 2.27e-09f 11
  45r 1.1894847e+06 1.14e+00 5.11e+02   0.5 3.42e+03    -  9.21e-01 1.01e-03f  1
  46  9.0834403e+05 1.14e+00 2.38e+02  -8.6 8.15e+15    -  5.76e-10 2.44e-17f  1
  47  4.7340310e+05 1.14e+00 2.38e+02  -8.6 2.00e+11    -  3.85e-09 2.17e-12f  1
  48  1.9985803e+05 1.14e+00 2.38e+02  -8.6 5.47e+09    -  2.35e-09 6.03e-10f  1
  49  1.9962850e+05 1.14e+00 2.38e+02  -8.6 5.41e+08    -  2.31e-07 3.68e-12f  1
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  50  1.1394831e+05 1.14e+00 2.38e+02  -8.6 5.19e+08    -  1.24e-07 1.85e-09f  1
  51  1.1394443e+05 1.14e+00 1.22e+02  -8.6 2.91e+05    -  7.62e-01 1.34e-11f  1
  52  2.0307100e+03 4.32e+00 4.76e+01  -8.6 4.06e+01    -  1.61e-01 7.62e-01f  1
  53  3.1560571e+02 7.47e+00 4.97e+00  -8.6 2.72e+01    -  9.24e-01 8.51e-01h  1
  54  1.7486026e+01 1.49e+00 3.64e-02  -8.6 1.04e+01    -  1.00e+00 9.90e-01h  1
  55  1.5078465e+01 3.91e-01 8.88e-03  -8.6 3.21e+00    -  1.00e+00 7.56e-01h  1
  56  1.4305769e+01 7.64e-03 1.26e-06  -8.6 8.71e-01    -  1.00e+00 1.00e+00h  1
  57  1.4306233e+01 1.50e-04 5.74e-08  -8.6 5.82e-02    -  1.00e+00 1.00e+00h  1
  58  1.4306243e+01 9.22e-08 2.21e-11  -8.6 1.69e-03    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 58

                                   (scaled)                 (unscaled)
Objective...............:   1.4306243053294509e-03    1.4306243053294509e+01
Dual infeasibility......:   2.2122023959588507e-11    2.2122023959588507e-07
Constraint violation....:   8.5813353138561434e-08    9.2235415749541971e-08
Variable bound violation:   0.0000000000000000e+00    0.0000000000000000e+00
Complementarity.........:   2.5059035661514700e-09    2.5059035661514698e-05
Overall NLP error.......:   8.5813353138561434e-08    2.5059035661514698e-05


Number of objective function evaluations             = 122
Number of objective gradient evaluations             = 58
Number of equality constraint evaluations            = 122
Number of inequality constraint evaluations          = 122
Number of equality constraint Jacobian evaluations   = 61
Number of inequality constraint Jacobian evaluations = 61
Number of Lagrangian Hessian evaluations             = 58
Total seconds in IPOPT                               = 4.980

EXIT: Optimal Solution Found.
      solver  :   t_proc      (avg)   t_wall      (avg)    n_eval
       nlp_f  |  15.24ms (124.89us)  15.32ms (125.60us)       122
       nlp_g  | 259.64ms (  2.13ms) 261.16ms (  2.14ms)       122
  nlp_grad_f  |  15.09ms (255.76us)  15.21ms (257.77us)        59
  nlp_hess_l  |   3.10 s ( 55.35ms)   3.12 s ( 55.67ms)        56
   nlp_jac_g  | 846.28ms ( 13.65ms) 851.59ms ( 13.74ms)        62
       total  |   4.95 s (  4.95 s)   4.98 s (  4.98 s)         1
  Success: True
  Cost: 14.3062
  Iterations: 58
  Solve time: 9.58 s
  Max obstacle slack: -9.9749e-09
  Min obstacle clearance: 0.0002 m

Generating Stage B plots...
  Saved: /run/media/saveas/Secondary-Storage/Masters/CS234/CS234_Reinforcement_Learning/Final Project/CS234_Final_Project/results/trajectory_optimization/ipopt_stage_b_trajectory.png
  Saved: /run/media/saveas/Secondary-Storage/Masters/CS234/CS234_Reinforcement_Learning/Final Project/CS234_Final_Project/results/trajectory_optimization/ipopt_stage_b_states.png
  Saved: /run/media/saveas/Secondary-Storage/Masters/CS234/CS234_Reinforcement_Learning/Final Project/CS234_Final_Project/results/trajectory_optimization/ipopt_stage_b_controls.png

Generating comparison plot...
  Saved: /run/media/saveas/Secondary-Storage/Masters/CS234/CS234_Reinforcement_Learning/Final Project/CS234_Final_Project/results/trajectory_optimization/ipopt_stage_comparison.png

Generating animation (Stage B)...
  Saved: /run/media/saveas/Secondary-Storage/Masters/CS234/CS234_Reinforcement_Learning/Final Project/CS234_Final_Project/results/trajectory_optimization/ipopt_stage_b_animation.gif

======================================================================
SUMMARY
======================================================================
Run                       Iters    Time [s]   Cost [s]   Max Sigma    Min Clear [m]  Success
-----------------------------------------------------------------------------------------------
Stage A (feas)            44       8.74       0.6435     -9.091e-09   0.0000         True
Stage B (time)            58       9.58       14.3062    -9.975e-09   0.0002         True

All outputs saved to: /run/media/saveas/Secondary-Storage/Masters/CS234/CS234_Reinforcement_Learning/Final Project/CS234_Final_Project/results/trajectory_optimization
